<div class="modal-header">
    <h4 class="modal-title">Add New User</h4>
    <button type="button" class="btn-close" (click)="cancel()" aria-label="Close"></button>
</div>

<!-- Prevent admin credential autofill -->
<div class="modal-body">
    <form autocomplete="off">
        <div class="mb-3">
            <label>Username</label>
            <input #usernameInput type="text" class="form-control" [(ngModel)]="userName" name="userName" required
                (ngModelChange)="markDirty()" autocomplete="off" autocapitalize="none" spellcheck="false" />
        </div>

        <div class="mb-3">
            <label>First Name</label>
            <input type="text" class="form-control" [(ngModel)]="firstName" name="firstName" required
                (ngModelChange)="markDirty()" />
        </div>

        <div class="mb-3">
            <label>Last Name</label>
            <input type="text" class="form-control" [(ngModel)]="lastName" name="lastName" required
                (ngModelChange)="markDirty()" />
        </div>

        <div class="mb-3">
            <label>Email</label>
            <input type="email" class="form-control" [(ngModel)]="email" name="email" required
                (ngModelChange)="markDirty()" autocomplete="off" />
        </div>

        <div class="mb-3">
            <label>Password</label>
            <div class="input-group">
                <!-- Stop saved-password injection -->
                <input [type]="showPassword ? 'text' : 'password'" class="form-control" [(ngModel)]="password"
                    name="newPassword" (ngModelChange)="markDirty()" autocomplete="new-password" autocapitalize="none"
                    spellcheck="false" />
                <span class="input-group-text" (click)="togglePasswordVisibility()" style="cursor: pointer;">
                    <i class="fas" [ngClass]="showPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
                </span>
            </div>
        </div>

        <div class="mb-3">
            <label>Role</label>
            <select class="form-select" [(ngModel)]="role" name="role" (ngModelChange)="markDirty()">
                <option *ngFor="let r of roles" [value]="r">{{ r }}</option>
            </select>
        </div>

        <div class="mb-3">
            <label>Semester 1 Modules</label>
            <div *ngFor="let mod of semester1Modules" class="form-check">
                <input class="form-check-input" type="checkbox" [value]="mod.id"
                    (change)="toggleModule(mod.id, selectedSemester1, $event)" />
                <label class="form-check-label">{{ mod.moduleCode }} - {{ mod.moduleName }}</label>
            </div>
        </div>

        <div class="mb-3">
            <label>Semester 2 Modules</label>
            <div *ngFor="let mod of semester2Modules" class="form-check">
                <input class="form-check-input" type="checkbox" [value]="mod.id"
                    (change)="toggleModule(mod.id, selectedSemester2, $event)" />
                <label class="form-check-label">{{ mod.moduleCode }} - {{ mod.moduleName }}</label>
            </div>
        </div>
    </form>
</div>

<div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="cancel()">Cancel</button>
    <button type="button" class="btn btn-primary" (click)="submit()">Submit</button>
</div>