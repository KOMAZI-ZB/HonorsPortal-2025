<div class="modal-header">
    <h5 class="modal-title">Edit Scheduling & Venue Details</h5>
    <button type="button" class="btn-close" aria-label="Close" (click)="cancel()"></button>
</div>

<div class="modal-body">
    <form>
        <!-- ðŸ§­ Tabs -->
        <ul class="nav nav-tabs mb-3">
            <li class="nav-item">
                <a class="nav-link" [class.active]="activeTab==='venue'" (click)="setTab('venue')">Venue</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" [class.active]="activeTab==='contact'" (click)="setTab('contact')">Contact
                    Sessions</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" [class.active]="activeTab==='assessments'"
                    (click)="setTab('assessments')">Assessments</a>
            </li>
        </ul>

        <div class="border border-top-0 rounded-bottom p-3">
            <!-- ================= Venue ================= -->
            <div [hidden]="activeTab !== 'venue'">
                <h6>Class Schedule</h6>
                <div class="mb-3">
                    <label>Venue</label>
                    <input type="text" class="form-control" [(ngModel)]="classVenue" name="classVenue" />
                </div>
            </div>

            <!-- ================= Contact Sessions ================= -->
            <div [hidden]="activeTab !== 'contact'">
                <h6>Class Days &amp; Times</h6>
                <div class="mb-3">
                    <div *ngFor="let day of weekDays" class="border rounded p-2 mb-2">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input" [checked]="selectedDaysMap[day].checked"
                                (change)="toggleDay(day)" [id]="day" />
                            <label class="form-check-label fw-bold" [for]="day">{{ day }}</label>
                        </div>

                        <div *ngIf="selectedDaysMap[day]?.checked" class="row">
                            <div class="col">
                                <label>Start Time</label>
                                <input type="time" class="form-control" [(ngModel)]="selectedDaysMap[day].startTime"
                                    [name]="'start-' + day" min="06:00" max="21:00" />
                            </div>
                            <div class="col">
                                <label>End Time</label>
                                <input type="time" class="form-control" [(ngModel)]="selectedDaysMap[day].endTime"
                                    [name]="'end-' + day" min="06:00" max="22:00" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ================= Assessments ================= -->
            <div [hidden]="activeTab !== 'assessments'">
                <hr />
                <h6>Assessments</h6>

                <div *ngFor="let assessment of assessments; let i = index" class="border rounded mb-3">
                    <!-- Collapsible Header -->
                    <button class="btn btn-light w-100 text-start p-3" type="button" data-bs-toggle="collapse"
                        [attr.data-bs-target]="'#collapse' + i" [attr.aria-expanded]="true"
                        [attr.aria-controls]="'collapse' + i">
                        <strong>ðŸ“˜ Assessment {{ i + 1 }}: {{ assessment.title || 'Untitled' }}</strong>
                    </button>

                    <!-- Collapsible Body -->
                    <div class="collapse show p-3" [id]="'collapse' + i">
                        <div class="mb-2">
                            <label>Title</label>
                            <input type="text" class="form-control" [(ngModel)]="assessment.title"
                                [name]="'title' + i" />
                        </div>

                        <div class="mb-2">
                            <label>Date</label>
                            <input type="date" class="form-control" [(ngModel)]="assessment.date" [name]="'date' + i" />
                        </div>

                        <div class="mb-2">
                            <label>
                                <input type="checkbox" [(ngModel)]="assessment.isTimed" [name]="'isTimed' + i" />
                                Timed Assessment (e.g., Venue &amp; Time)
                            </label>
                        </div>

                        <div *ngIf="assessment.isTimed">
                            <div class="mb-2">
                                <label>Venue</label>
                                <input type="text" class="form-control" [(ngModel)]="assessment.venue"
                                    [name]="'venue' + i" />
                            </div>
                            <div class="row">
                                <div class="col">
                                    <label>Start Time</label>
                                    <input type="time" class="form-control" [(ngModel)]="assessment.startTime"
                                        [name]="'startTime' + i" />
                                </div>
                                <div class="col">
                                    <label>End Time</label>
                                    <input type="time" class="form-control" [(ngModel)]="assessment.endTime"
                                        [name]="'endTime' + i" />
                                </div>
                            </div>
                        </div>

                        <div *ngIf="!assessment.isTimed" class="mb-2">
                            <label>Submission Deadline</label>
                            <input type="time" class="form-control" [(ngModel)]="assessment.dueTime"
                                [name]="'dueTime' + i" />
                        </div>

                        <div class="text-end mt-3">
                            <button class="btn btn-sm btn-outline-danger" (click)="removeAssessment(i)" type="button">
                                Remove
                            </button>
                        </div>
                    </div>
                </div>

                <!-- âž• Add Assessment -->
                <div class="mb-3 text-end">
                    <button class="btn btn-outline-primary" (click)="addAssessment()" type="button">
                        + Add Assessment
                    </button>
                </div>
            </div>
        </div>
    </form>
</div>

<div class="modal-footer">
    <button class="btn btn-secondary" (click)="cancel()">Cancel</button>
    <button class="btn btn-primary" (click)="submit()">Save Changes</button>
</div>